# Global settings applied to all applications
global:
  cluster:
    serverip: 192.168.1.3
    username: root
    cluster-name: hess.pm
    ip-range: 192.168.1.80-192.168.1.90

  # Common domain configuration
  domain: hess.pm

  # Authentication settings
  akeyless:
    path: /hess.pm

  # Email settings for services
  email: Jonas@Hess.pm

  # DNS provider configuration
  cloudflare:
    email: Jonas@Hess.pm

  # Certificate management
  letsencrypt:
    email: Jonas@Hess.pm

  # Authentication provider
  oauth2_proxy:
    oidc_client_id: "6e1bl5i55ao7bhhcufk85ussm"
    oidc_issuer_url: "https://cognito-idp.eu-central-1.amazonaws.com/eu-central-1_t9DQfKlSX"

  argocd:
    targetRevision: main

# All applications to be deployed by Argo CD
apps:
  homer:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: { }
    additionalLinks:
      githubEnvironments:
        name: "Environments"
        group: "infrastructure"
        subtitle: "GitHub"
        logo: "https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/github.svg"
        url: "https://github.com/JonasHess/homelab-environments"
      adguardHomeserver:
        name: "AdGuard"
        group: "infrastructure"
        subtitle: "DNS Homeserver"
        logo: "https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/adguard-home.svg"
        url: "https://adguard.home-server.dev"
      ispRouter:
        name: "ISP Router"
        group: "infrastructure"
        subtitle: "192.168.0.1"
        logo: "https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/router.svg"
        url: "http://192.168.0.1"
      firewall:
        name: "UniFi Firewall"
        group: "infrastructure"
        subtitle: "192.168.1.1"
        logo: "https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/unifi.svg"
        url: "http://192.168.1.1"
      proxmox:
        name: "Proxmox"
        group: "infrastructure"
        subtitle: "Virtualization"
        logo: "https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/svg/proxmox.svg"
        url: "https://192.168.1.2:8006/"
  mosquitto:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  paperlessgpt:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                prompts:
                  hostPath: /mnt/tank1/encrypted/apps/paperless-gpt/prompts
          LLM_PROVIDER: openai
          LLM_MODEL: gpt-5.1
          CORRESPONDENT_BLACK_LIST: "Jonas He\xDF, Lena Raab, Lena He\xDF"
          AWS_OCR_BUCKET_NAME: paperless-ocr
          PROMPT_PREAMBLE: "Dein Name ist Jonas He\xDF. Du arbeitest als Softwareentwickler.\
            \ Du bist geboren am 24.02.1993. Du wohnst in der Heinrich-B\xF6ll-Str.\
            \ 40a Bruchk\xF6bel."
          PROMPT_TITLE_EXPLANATION: ''
          PROMPT_TAGS_EXPLANATION: ''
          PROMPT_DOCUMENT_TYPE_EXPLANATION: ''
          PROMPT_CORRESPONDENT_EXPLANATION: ''
          PROMPT_POSTAMBLE: ''
  duplicati:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/encrypted/apps/duplicati/config
                tank1:
                  mountPath: /mnt/tank1
                  hostPath: /mnt/tank1
                tank0:
                  mountPath: /mnt/tank0
                  hostPath: /mnt/tank0
  prowlarr:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/prowlarr/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
  homeassistant:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          externalConfig:
            repoURL: "https://github.com/JonasHess/homelab-environments.git"
            targetRevision: "main"
            path: "hess.pm/homeassistant-config"
            configMapName: "homeassistant-app-config"
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/homeassistant/config
              initContainers:
                - name: copy-config
                  image: busybox:1.36
                  command:
                    - sh
                    - -c
                    - |
                      echo "Copying config files from ConfigMap to /config..."
                      cp /configmap/*.yaml /config/
                      echo "Config files copied successfully"
                  volumeMounts:
                    - name: homeassistant-config-volume
                      mountPath: /config
                    - name: homeassistant-configmap-volume
                      mountPath: /configmap
              configMapMounts:
                configmap:
                  mountPath: /configmap
                  configMapName: homeassistant-app-config
  adguard:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/adguard/config
                data:
                  hostPath: /mnt/tank1/encrypted/apps/adguard/data
  qbittorrent:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/qbittorrent/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
                downloads:
                  hostPath: /data/volumes/qbittorrent-downloads
                watchdir:
                  hostPath: /mnt/tank1/unencrypted/apps/watchdir
  redis:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/redis/data
  immich:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            persistentVolumeClaims:
              library:
                hostPath: /mnt/tank0/encrypted/apps/immich/library
              postgresql:
                hostPath: /mnt/tank1/encrypted/apps/immich/postgresql
              redis:
                hostPath: /mnt/tank1/encrypted/apps/immich/redis
              cli:
                hostPath: /mnt/truenas/bilder
          importJob:
            enabled: false
          smtp:
            enabled: true
            host: email-smtp.eu-central-1.amazonaws.com
            username: AKIAZE6KDVU2EPZKN2IL
            from: Immich Photo Server <immich@hess.pm>
  smarthome3:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            configMaps:
              smarthome3-config-map:
                HUE_IP: "192.168.1.251"
                MQTT_URL: "tcp://mosquitto-service:1883"
                HOME_ASSISTANT_IP: "ws://homeassistant-service:8123"
                spring.profiles.active: "jonas"
  smarthome4:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            configMaps:
              smarthome4-config-map:
                SPRING_PROFILES_ACTIVE: "prod"
                MQTT_BROKER_HOST: "mosquitto-service"
                MQTT_BROKER_PORT: "1883"
                HOMEASSISTANT_BASEURL: "http://homeassistant-service:8123"
                HOMEASSISTANT_CACHE_MAXAGEMS: "60000"
                DEVICE_STATE_TIMEOUT_SECONDS: "300"
                APPLICATION_MODEL_REFRESH_ENABLED: "true"
                APPLICATION_MODEL_REFRESH_INTERVAL_MS: "300000"
                APPLICATION_MODEL_REFRESH_INITIAL_DELAY_MS: "60000"
          externalConfig:
            repoURL: "https://github.com/JonasHess/homelab-environments.git"
            targetRevision: "main"
            path: "hess.pm/smarthome4-config"
            configMapName: "smarthome4-app-config"
  smarthome4-ui:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            configMaps:
              smarthome4-ui-config-map:
                GITHUB_REPO: "JonasHess/homelab-environments"
                GITHUB_CONFIG_PATH: "hess.pm/smarthome4-config/smarthome-config.yaml"
                GITHUB_ALEXA_CONFIG_PATH: "hess.pm/homeassistant-config/alexa.yaml"
                GITHUB_BRANCH: "main"
  alexa-smarthome-skill:
    enabled: true
    argocd:
      namespace: "homeassistant"
      targetRevision: ~
      helm:
        values:
          skillId: "amzn1.ask.skill.fa708930-0ce8-422c-a5a2-aaca11b649f8"
          lambdaArn: "arn:aws:lambda:eu-west-1:629099703604:function:HomeAssistant"
          lambdaRegion: "eu-west-1"
          homeAssistantUrl: "https://homeassistant.hess.pm"
          files:
            skillJson: |
              {
                "manifest": {
                  "apis": {
                    "smartHome": {
                      "endpoint": {
                        "uri": "{{ .Values.lambdaArn }}"
                      },
                      "protocolVersion": "3"
                    }
                  },
                  "manifestVersion": "1.0",
                  "publishingInformation": {
                    "locales": {
                      "de-DE": {
                        "name": "HomeAssistant"
                      }
                    }
                  }
                }
              }

  argocd:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  gotenberg:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  paperlessngx:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/paperlessngx/data
                media:
                  hostPath: /mnt/tank1/encrypted/apps/paperlessngx/media
                export:
                  hostPath: /mnt/tank1/encrypted/apps/paperlessngx/export
                consume:
                  hostPath: /mnt/tank1/encrypted/apps/paperlessngx/consume
          admin:
            username: jonas
            email: Jonas@Hess.pm
  sabnzbd:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/sabnzbd/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
                downloads:
                  hostPath: /data/volumes/sabnzbd-downloads
                watchdir:
                  hostPath: /mnt/tank1/unencrypted/apps/watchdir
  githubarc:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values:
          storageclasses:
            standard:
              hostPath: /mnt/tank1/unencrypted/apps/githubarc/storage/standard
  stirlingpdf:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                scanner:
                  hostPath: /mnt/tank1/encrypted/apps/stirlingpdf/pipeline/watchedFolders/scanner
                paperlessconsume:
                  hostPath: /mnt/tank1/encrypted/apps/paperlessngx/consume
  freshrss:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/freshrss/data
  radarr:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/radarr/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
  search:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  postgres:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/postgres/data
  tika:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  akeyless:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  zigbee2mqtt:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            configMaps:
              zigbee2mqtt-config-map:
                ZIGBEE2MQTT_CONFIG_SERIAL_PORT: "tcp://192.168.1.183:6638"
                ZIGBEE2MQTT_CONFIG_SERIAL_ADAPTER: "ember"
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/unencrypted/apps/zigbee2mqtt/data
  asn:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}
  plex:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/encrypted/apps/plex/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
  jellyfin:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/encrypted/apps/jellyfin/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
  tautulli:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/tautulli/config
  aws:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          ecrRegistries:
            - name: primary
              region: eu-central-1
              namespace: argocd
              schedule: "0 */10 * * *"
#            # Add additional ECR accounts as needed
#            - name: secondary
#              region: eu-central-1
#              namespace: argocd
#              schedule: "0 */10 * * *"
  prometheus:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            persistentVolume:
              prometheus: /mnt/tank1/unencrypted/apps/prometheus/data
            persistentVolumeClaims:
              grafana:
                hostPath: /mnt/tank1/unencrypted/apps/prometheus/grafana/data
              alertmanager:
                hostPath: /mnt/tank1/unencrypted/apps/prometheus/alertmanager/data
  sftpgo:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/sftpgo/data
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/sftpgo/config
                tank0:
                  mountPath: /mnt/tank0
                  hostPath: /mnt/tank0
                tank1:
                  mountPath: /mnt/tank1
                  hostPath: /mnt/tank1
                stirlingpdf:
                  mountPath: /mnt/stirlingpdf/pipeline/
                  hostPath: /mnt/tank1/encrypted/apps/stirlingpdf/pipeline/
  sonarr:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/sonarr/config
                media:
                  hostPath: /mnt/tank0/encrypted/media
  traefik:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            persistentVolumeClaims:
              data:
                hostPath: /mnt/tank1/unencrypted/apps/traefik
          additionalExposedPorts:
            plex:
              port: 32400
              protocol: TCP
          loadBalancerIP: 192.168.1.80
          middlewares:
            cloudflare:
              allowedCIDRs:
                - 192.168.1.0/24
          oauth2-proxy:
            extraArgs:
              oidc-issuer-url: "https://cognito-idp.eu-central-1.amazonaws.com/eu-central-1_t9DQfKlSX"
              cookie-domain: ".hess.pm"
              whitelist-domain: ".hess.pm"
              redirect-url: "https://auth.hess.pm/oauth2/callback"
  duplicatiprometheusexporter:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values: {}
  audiobookshelf:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/encrypted/apps/audiobookshelf/config
                metadata:
                  hostPath: /mnt/tank1/encrypted/apps/audiobookshelf/metadata
                media:
                  hostPath: /mnt/tank0/encrypted/media

  mealie:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          global:
            oidcConfigurationUrl: https://cognito-idp.eu-central-1.amazonaws.com/eu-central-1_t9DQfKlSX/.well-known/openid-configuration
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/mealie/data
                  backup:
                    restore: true

  whoami:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}

  reloader:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values: {}

  restic:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            persistentVolumeClaims:
              tank1:
                hostPath: /mnt/tank1
              tank0:
                hostPath: /mnt/tank0
              restoreddata:
                hostPath: /mnt/tank0/encrypted/apps/restic/restored-data
          cronjob:
            pvcMounts:
              tank1:
                mountPath: /mnt/tank1
              tank0:
                mountPath: /mnt/tank0

  filecleanup:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            persistentVolumeClaims:
              sabnzbd-download:
                hostPath: /data/volumes/sabnzbd-downloads
              sabnzbd-unknown:
                hostPath: /mnt/tank0/encrypted/media/_unknown/sabnzbd
              nzbget-download:
                hostPath: /data/volumes/nzbget-downloads
              nzbget-radarr:
                hostPath: /mnt/tank0/encrypted/media/_unknown/nzbget/Radarr
              nzbget-prowlarr:
                hostPath: /mnt/tank0/encrypted/media/_unknown/nzbget/Prowlarr
          filecleanup:
            dryRun: false  # Set to false after testing
            cleanupJobs:
              sabnzbd-download:
                retentionDays: 3
                cleanupEmptyDirs: true
                schedule: "0 2 * * *"  # 2 AM daily
              sabnzbd-unknown:
                retentionDays: 3
                cleanupEmptyDirs: true
                schedule: "0 3 * * *"  # 3 AM daily
              nzbget-download:
                retentionDays: 3
                cleanupEmptyDirs: true
                schedule: "0 4 * * *"
              nzbget-radarr:
                retentionDays: 3
                cleanupEmptyDirs: true
                schedule: "0 5 * * *"
              nzbget-prowlarr:
                retentionDays: 3
                cleanupEmptyDirs: true
                schedule: "0 6 * * *"

  crossplane:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values: { }

  profilarr:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/encrypted/apps/profilarr/config
  overseerr:
    enabled: false
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/encrypted/apps/overseerr/config

  backrest:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            persistentVolumeClaims:
              data:
                hostPath: /mnt/tank1/encrypted/apps/backrest/data
              cache:
                hostPath: /mnt/tank1/encrypted/apps/backrest/cache
              tmp:
                hostPath: /mnt/tank1/encrypted/apps/backrest/tmp
              restore:
                hostPath: /mnt/tank1/encrypted/apps/backrest/restore
  radicale:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                data:
                  hostPath: /mnt/tank1/encrypted/apps/radicale/data
  nzbget:
    enabled: true
    argocd:
      targetRevision: ~
      helm:
        values:
          generic:
            deployment:
              pvcMounts:
                config:
                  hostPath: /mnt/tank1/unencrypted/apps/nzbget/config
                  backup:
                    enabled: true
                downloads:
                  hostPath: /data/volumes/nzbget-downloads
                media:
                  hostPath: /mnt/tank0/encrypted/media